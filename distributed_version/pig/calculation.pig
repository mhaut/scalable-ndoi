REGISTER calculation.jar;
IMPORT 'pig-import-calculation.pig';

data = LOAD 'AVIRIS_1.csv' USING org.apache.pig.piggybank.storage.CSVExcelStorage(',', 'YES_MULTILINE', 'NOCHANGE') AS (dato0:int,dato1:int,dato2:int,dato3:int,dato4:int,dato5:int,dato6:int,dato7:int,dato8:int,dato9:int,dato10:int,dato11:int,dato12:int,dato13:int,dato14:int,dato15:int,dato16:int,dato17:int,dato18:int,dato19:int,dato20:int,dato21:int,dato22:int,dato23:int,dato24:int,dato25:int,dato26:int,dato27:int,dato28:int,dato29:int,dato30:int,dato31:int,dato32:int,dato33:int,dato34:int,dato35:int,dato36:int,dato37:int,dato38:int,dato39:int,dato40:int,dato41:int,dato42:int,dato43:int,dato44:int,dato45:int,dato46:int,dato47:int,dato48:int,dato49:int,dato50:int,dato51:int,dato52:int,dato53:int,dato54:int,dato55:int,dato56:int,dato57:int,dato58:int,dato59:int,dato60:int,dato61:int,dato62:int,dato63:int,dato64:int,dato65:int,dato66:int,dato67:int,dato68:int,dato69:int,dato70:int,dato71:int,dato72:int,dato73:int,dato74:int,dato75:int,dato76:int,dato77:int,dato78:int,dato79:int,dato80:int,dato81:int,dato82:int,dato83:int,dato84:int,dato85:int,dato86:int,dato87:int,dato88:int,dato89:int,dato90:int,dato91:int,dato92:int,dato93:int,dato94:int,dato95:int,dato96:int,dato97:int,dato98:int,dato99:int,dato100:int,dato101:int,dato102:int,dato103:int,dato104:int,dato105:int,dato106:int,dato107:int,dato108:int,dato109:int,dato110:int,dato111:int,dato112:int,dato113:int,dato114:int,dato115:int,dato116:int,dato117:int,dato118:int,dato119:int,dato120:int,dato121:int,dato122:int,dato123:int,dato124:int,dato125:int,dato126:int,dato127:int,dato128:int,dato129:int,dato130:int,dato131:int,dato132:int,dato133:int,dato134:int,dato135:int,dato136:int,dato137:int,dato138:int,dato139:int,dato140:int,dato141:int,dato142:int,dato143:int,dato144:int,dato145:int,dato146:int,dato147:int,dato148:int,dato149:int,dato150:int,dato151:int,dato152:int,dato153:int,dato154:int,dato155:int,dato156:int,dato157:int,dato158:int,dato159:int,dato160:int,dato161:int,dato162:int,dato163:int,dato164:int,dato165:int,dato166:int,dato167:int,dato168:int,dato169:int,dato170:int,dato171:int,dato172:int,dato173:int,dato174:int,dato175:int,dato176:int,dato177:int,dato178:int,dato179:int,dato180:int,dato181:int,dato182:int,dato183:int,dato184:int,dato185:int,dato186:int,dato187:int,dato188:int,dato189:int,dato190:int,dato191:int,dato192:int,dato193:int,dato194:int,dato195:int,dato196:int,dato197:int,dato198:int,dato199:int,dato200:int,dato201:int,dato202:int,dato203:int,dato204:int,dato205:int,dato206:int,dato207:int,dato208:int,dato209:int,dato210:int,dato211:int,dato212:int,dato213:int,dato214:int,dato215:int,dato216:int,dato217:int,dato218:int,dato219:int,dato220:int,dato221:int,dato222:int,dato223:int,dato224:int);

res = FOREACH data GENERATE II_CALCULATION(dato0 ,dato1 ,dato2 ,dato3 ,dato4 ,dato5 ,dato6 ,dato7 ,dato8 ,dato9 ,dato10 ,dato11 ,dato12 ,dato13 ,dato14 ,dato15 ,dato16 ,dato17 ,dato18 ,dato19 ,dato20 ,dato21 ,dato22 ,dato23 ,dato24 ,dato25 ,dato26 ,dato27 ,dato28 ,dato29 ,dato30 ,dato31 ,dato32 ,dato33 ,dato34 ,dato35 ,dato36 ,dato37 ,dato38 ,dato39 ,dato40 ,dato41 ,dato42 ,dato43 ,dato44 ,dato45 ,dato46 ,dato47 ,dato48 ,dato49 ,dato50 ,dato51 ,dato52 ,dato53 ,dato54 ,dato55 ,dato56 ,dato57 ,dato58 ,dato59 ,dato60 ,dato61 ,dato62 ,dato63 ,dato64 ,dato65 ,dato66 ,dato67 ,dato68 ,dato69 ,dato70 ,dato71 ,dato72 ,dato73 ,dato74 ,dato75 ,dato76 ,dato77 ,dato78 ,dato79 ,dato80 ,dato81 ,dato82 ,dato83 ,dato84 ,dato85 ,dato86 ,dato87 ,dato88 ,dato89 ,dato90 ,dato91 ,dato92 ,dato93 ,dato94 ,dato95 ,dato96 ,dato97 ,dato98 ,dato99 ,dato100 ,dato101 ,dato102 ,dato103 ,dato104 ,dato105 ,dato106 ,dato107 ,dato108 ,dato109 ,dato110 ,dato111 ,dato112 ,dato113 ,dato114 ,dato115 ,dato116 ,dato117 ,dato118 ,dato119 ,dato120 ,dato121 ,dato122 ,dato123 ,dato124 ,dato125 ,dato126 ,dato127 ,dato128 ,dato129 ,dato130 ,dato131 ,dato132 ,dato133 ,dato134 ,dato135 ,dato136 ,dato137 ,dato138 ,dato139 ,dato140 ,dato141 ,dato142 ,dato143 ,dato144 ,dato145 ,dato146 ,dato147 ,dato148 ,dato149 ,dato150 ,dato151 ,dato152 ,dato153 ,dato154 ,dato155 ,dato156 ,dato157 ,dato158 ,dato159 ,dato160 ,dato161 ,dato162 ,dato163 ,dato164 ,dato165 ,dato166 ,dato167 ,dato168 ,dato169 ,dato170 ,dato171 ,dato172 ,dato173 ,dato174 ,dato175 ,dato176 ,dato177 ,dato178 ,dato179 ,dato180 ,dato181 ,dato182 ,dato183 ,dato184 ,dato185 ,dato186 ,dato187 ,dato188 ,dato189 ,dato190 ,dato191 ,dato192 ,dato193 ,dato194 ,dato195 ,dato196 ,dato197 ,dato198 ,dato199 ,dato200 ,dato201 ,dato202 ,dato203 ,dato204 ,dato205 ,dato206 ,dato207 ,dato208 ,dato209 ,dato210 ,dato211 ,dato212 ,dato213 ,dato214 ,dato215 ,dato216 ,dato217 ,dato218 ,dato219 ,dato220 ,dato221 ,dato222 ,dato223 ,dato224);

STORE res INTO 'indices' USING PigStorage(',');
